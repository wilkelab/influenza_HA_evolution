source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Desktop/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
r.value.1
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
show(p)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
show(p)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
show(p)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
show(p)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
show(p)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
show(p)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
show(p)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
rs
r.11
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
show(p)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
show(p)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
show(p)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
show(p)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
show(p)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
sqrt(rs)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
rs
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
rs
summary(m1)
summary(m10)
summary(m11)
sqrt(0.3357)
sqrt(0.676)
sqrt(0.3676)
r.value.3
r.value.2
rs
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsquared_barplot.R')
r.3
r.value.3
r.value.3^2
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
sqrt(0.135)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
require(cowplot)
rm(list=ls())
gg_color_hue <- function(n) {
hues = seq(15, 375, length=n+1)
hcl(h=hues, l=65, c=100)[1:n]
}
cols = rev(gg_color_hue(3))
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.1 <- ggplot() +
geom_point(data=d, aes(x=RSA.Multimer, y=FEL.dN.dS, color=Bush.99), alpha=0.75) +
scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, length=4)) +
ylim(0, 3.73) +
xlab("Predicted dN/dS") +
ylab("Relative Solvent Accessibility") +
geom_path(data=data.frame(x=c(0,1), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=1.9, y=0.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
require(cowplot)
rm(list=ls())
gg_color_hue <- function(n) {
hues = seq(15, 375, length=n+1)
hcl(h=hues, l=65, c=100)[1:n]
}
cols = rev(gg_color_hue(3))
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.1 <- ggplot() +
geom_point(data=d, aes(x=RSA.Multimer, y=FEL.dN.dS, color=Bush.99), alpha=0.75) +
scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, length=4)) +
ylim(0, 3.73) +
xlab("Predicted dN/dS") +
ylab("Relative Solvent Accessibility") +
geom_path(data=data.frame(x=c(0,1), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=0.75, y=0.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer + Bush.99, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.2 <- ggplot() +
geom_point(data=d, aes(x=(1/distance.to.224), y=FEL.dN.dS, colour=Bush.99), alpha=0.75) +
scale_x_continuous(limits=c(0, 0.25), breaks=seq(0, 0.25, length=4)) +
ylim(0, 3.73) +
xlab("Predicted dN/dS") +
ylab("Inverse Distance to Site 224") +
geom_path(data=data.frame(x=c(0,0.25), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=0.75, y=0.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
p <- plot_grid(p1.1, p1.2, cols=2)
require(cowplot)
rm(list=ls())
gg_color_hue <- function(n) {
hues = seq(15, 375, length=n+1)
hcl(h=hues, l=65, c=100)[1:n]
}
cols = rev(gg_color_hue(3))
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.1 <- ggplot() +
geom_point(data=d, aes(x=RSA.Multimer, y=FEL.dN.dS, color=Bush.99), alpha=0.75) +
scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, length=4)) +
ylim(0, 3.73) +
xlab("Predicted dN/dS") +
ylab("Relative Solvent Accessibility") +
geom_path(data=data.frame(x=c(0,1), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=0.75, y=0.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
show(p1.1)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer + Bush.99, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.2 <- ggplot() +
geom_point(data=d, aes(x=(1/distance.to.224), y=FEL.dN.dS, colour=Bush.99), alpha=0.75) +
scale_x_continuous(limits=c(0, 0.25), breaks=seq(0, 0.25, length=4)) +
ylim(0, 3.73) +
xlab("Predicted dN/dS") +
ylab("Inverse Distance to Site 224") +
geom_path(data=data.frame(x=c(0,0.25), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=0.75, y=0.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
show(p1.2)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
m
summary(m)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
d[d$FEL.dN.dS > 3.7]
d[d$FEL.dN.dS > 3.7, ]
d[d$FEL.dN.dS > 3.6, ]
d[d$FEL.dN.dS > 3.5, ]
d[d$FEL.dN.dS > 3.3, ]
d[d$FEL.dN.dS > 3.1, ]
d[d$FEL.dN.dS > 2.5, ]
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
m <- lm(FEL.dN.dS ~ I(1/distance.to.224) + RSA.Multimer, data=d)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ I(1/distance.to.224) + RSA.Multimer, data=d)
summary(m)
d <- d[d$FEL.dN.dS < 3.0, ]
m <- lm(FEL.dN.dS ~ I(1/distance.to.224) + RSA.Multimer, data=d)
summary(m)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
d <- d[d$FEL.dN.dS < 3.5, ]
m <- lm(FEL.dN.dS ~ I(1/distance.to.224) + RSA.Multimer, data=d)
summary(m)
sqrt(0.2616)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
d <- d[d$FEL.dN.dS < 3.8, ]
m <- lm(FEL.dN.dS ~ I(1/distance.to.224) + RSA.Multimer, data=d)
summary(m)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
require(cowplot)
rm(list=ls())
gg_color_hue <- function(n) {
hues = seq(15, 375, length=n+1)
hcl(h=hues, l=65, c=100)[1:n]
}
cols = rev(gg_color_hue(3))
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.1 <- ggplot() +
geom_point(data=d, aes(x=RSA.Multimer, y=FEL.dN.dS, size=distance.to.224), alpha=0.75, size=2) +
scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, by=0.2)) +
scale_size(name='1 / distance\nto site 224', range = c(2, 6)) +
ylim(0, 3.73) +
xlab("Relative Solvent Accessibility") +
ylab("dN/dS") +
geom_path(data=data.frame(x=c(0,1), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=0.15, y=3.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
show(p1.1)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
show(p1.1)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
d
d <- d[d$FEL.dN.dS < 3.0, ]
fit <- lm(FEL.dN.dS ~ REL.Multimer, data=d)
fit <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
summary(fit)
fit <- lm(FEL.dN.dS ~ I(1/distance.to.244), data=d)
fit <- lm(FEL.dN.dS ~ I(1/distance.to.224), data=d)
summary(fit)
d <- d[d$FEL.dN.dS < 2.5, ]
fit <- lm(FEL.dN.dS ~ I(1/distance.to.224), data=d)
summary(fit)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
d <- d[d$RSA.Multimer < 0.75, ]
fit <- lm(FEL.dN.dS ~ I(1/distance.to.224), data=d)
summary(fit)
fit <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
summary(fit)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
d
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.1 <- ggplot() +
geom_point(data=d, aes(x=predicted.w, y=FEL.dN.dS, size=1/distance.to.224, color=RSA.Multimer), alpha=0.75) +
scale_x_continuous(limits=c(0, 2.25), breaks=c(0, 1, 2)) +
scale_colour_gradientn(colours = cols, name='    RSA') +
scale_size(name='1 / distance\nto site 224', range = c(2, 6)) +
ylim(0, 3.73) +
xlab("Predicted dN/dS") +
ylab("Observed dN/dS") +
geom_path(data=data.frame(x=c(0,2.25), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=1.9, y=0.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
levels(d$Bush.99)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer + Bush.99, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
summary(m)
levels(d$Bush.99)
levels(factors(d$Bush.99))
levels(factor(d$Bush.99))
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
predicted.w=predict(m, d)
predicted.w
predicted.w > 1
require(cowplot)
rm(list=ls())
gg_color_hue <- function(n) {
hues = seq(15, 375, length=n+1)
hcl(h=hues, l=65, c=100)[1:n]
}
cols = rev(gg_color_hue(3))
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.1 <- ggplot() +
geom_point(data=d, aes(x=RSA.Multimer, y=FEL.dN.dS, size=1/distance.to.224), alpha=0.75) +
scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, by=0.2)) +
scale_size(name='1 / distance\nto site 224', range = c(2, 6)) +
ylim(0, 3.73) +
xlab("Relative Solvent Accessibility") +
ylab("dN/dS") +
geom_path(data=data.frame(x=c(0,1), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=0.15, y=3.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
show(p1.1)
d$predicted.w
d$predicted.w >1
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/manuscript/cross_val_function.R')
summary(fit)
fit <- lm(FEL.dN.dS ~ I(1/distance.to.224), data = df)
summary(fit)
fit <- lm(df$distance.to.224 ~ df$Meyer.14)
summary(fit)
